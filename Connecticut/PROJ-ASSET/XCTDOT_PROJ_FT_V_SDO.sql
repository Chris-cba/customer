DROP VIEW ATLAS.XCTDOT_PROJ_FT_V_SDO;

/* Formatted on 16/04/2014 19:40:03 (QP5 v5.256.13226.35510) */
CREATE OR REPLACE FORCE VIEW ATLAS.XCTDOT_PROJ_FT_V_SDO
AS
   SELECT
		a.PROJECTTYPEID,
		a.PROJ_NAME,
		a.PROJ_DESCRIPTION,
		a.PROJ_DESC_TITLE,
		a.ASSETS_BRIDGE_NOS_IN,
		a.ASSETS_PAVEMENT_TREAT,
		a.ASSETS_RETAINING_WALL,
		a.ASSETS_SIGN_STRUCTURE,
		a.ASSETS_SIGNAL_SYSTEM,
		a.CONS_INSPECTOR,
		a.CONS_MANAGER,
		a.CONS_AS_BUILT,
		a.CONTRACTOR,
		a.COST_PE_EXPENDITURES,
		a.COST_ROW_ESTBUDGET,
		a.DES_CONSULTANT_ENG,
		a.CONS_DES_PRIMARY,
		a.DES_PROJ_MAN,
		a.DES_PROJ_MAN_EMAIL,
		a.FHWA_OVERSIGHT,
		a.GEN_PROGRAM_NUMBE,
		a.GEN_DESCRIPTION,
		a.GEN_CONTR_NUM,
		a.PROJ_CURRENT_PHASE,
		--a.PROJ_NUMBER,
		a.SCHED_FDP_DES,
		a.SCHED_FDP_RPM,
		a.SCHED_NOTICE_TO_PR,
		a.SCHED_INIT,
		a.SCHED_RPM_DATE,
		a.PROJ_REMARKS,
		a.GEN_PROJ_INHERITED,
		a.GEN_PHASE_TYPES_INCL,
		a.GEN_STIP_STATUS,
		a.SCHED_ROW_INIT,
		a.COST_ROW_EXPENDITURES,
		a.COST_CONST_EXP,
		a.PROJ_END_DATE,
		a.PROJ_END_DATE_REASON,
		a.LOC_TOWNS,
		--a.BRIDGE_NUMBER,
		a.SCHED_CURRENT_EST_CCD,
		a.SCHED_ADV_CURRENT,
		a.SCHED_CONS_COMPLETION,
		a.SCHED_CURRENT_DCD,
		a.SCHED_CURRENT_FDP,
		a.CONS_CONSULTANT_INSPECT_FIRM,
		a.CONS_PRIMARY_INSPECTOR,
		a.CONS_SUPERVISING_ENGINEER,
		a.CONS_PERCENT_COMPLETE,
		a.CONS_SUPERVISING_ENG_EMAIL,
		a.COST_CONS_ORIG_CONTRACT_VAL,
		a.COST_REVISED_ORIG_CONTRACT_VAL,
		a.COST_CONS_TOT_EST_AT_DCD,
		--a.COST_CONS_TOT_EST_AT_DES_APPR,
		a.COST_CONS_TOT_EST_AT_RPM,
		a.COST_PE_EST_AT_DES_APPR,
		a.COST_TOT_PROJ_EST,
		a.COST_CURRENT_CONS_TOT_EST,
		a.DES_PROJECT_ENGINEER,
		a.PROJECT_DISTRICT,
		a.GEN_PROJECT_SCOPE_CODE,
		a.LOC_END_MILEPOINT,
		a.LOC_BEGIN_MILEPOINT,
		a.DES_PERCENT_COMPLETE,
		A.COST_CONS_TOT_EST_AT_DES_APPR,
		a.LOC_ROUTES,
		a.SCHED_AWARD,
		a.SCHED_DATE_OF_DES_APPR,
		a.SCHED_EST_CCD_AT_AWARD,
		--a.SIGNAL_SYSTEM_NO,
		a.PROJ_TYPE,
		a.SCHED_CONST_INIT,
		a.PROJ_GUID,
		b.IIT_NE_ID,
		b.IIT_INV_TYPE,
		b.IIT_PRIMARY_KEY,
		b.IIT_START_DATE,
		b.IIT_DATE_CREATED,
		b.IIT_DATE_MODIFIED,
		b.IIT_CREATED_BY,
		b.IIT_MODIFIED_BY,
		b.IIT_ADMIN_UNIT,
		b.IIT_DESCR,
		b.IIT_NOTE,
		b.IIT_PEO_INVENT_BY_ID,
		b.NAU_UNIT_CODE,
		b.IIT_END_DATE,
		b.PROJECT_TYPE,
		b.PROJECT_END_DATE,
		b.PROJECT_DIRECTION,
		b.PROJECT_SECTION,
		b.NE_ID_OF,
		b.MEMBER_UNIQUE,
		b.NM_BEGIN_MP,
		b.NM_END_MP,
		objectid,
		geoloc
     FROM XCTDOT_PW_PROJ_FT a, v_nm_ploc_nw b, nm_nit_ploc_sdo c
    WHERE     1 = 1
          AND NVL (B.PROJECT_NUMBER, 'UNKNOWN') = a.PROJ_NAME
          AND a.proj_name NOT IN (SELECT proj_name
                                    FROM (  SELECT COUNT (*), proj_name
                                              FROM XCTDOT_PW_PROJ_FT
                                          GROUP BY proj_name
                                            HAVING COUNT (*) > 1))
          AND c.ne_id = b.iit_ne_id
          AND c.ne_id_of = b.ne_id_of
          AND c.nm_begin_mp = b.nm_begin_mp;